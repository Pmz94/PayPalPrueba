<!DOCTYPE html>
<html lang = "es">

<head>
	<meta charset = "UTF-8">
	<meta name = "viewport" content = "width=device-width, initial-scale=1.0">
	<meta http-equiv = "X-UA-Compatible" content = "ie=edge">
	<link rel = "shortcut icon" type = "image/x-icon" href = "asset/img/favicon.ico">
	<title>PayPalPrueba</title>
	<link rel = "stylesheet" href = "https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.1/css/bootstrap.css">
	<link rel = "stylesheet" href = "asset/css/style.css">
</head>

<style>
	img.paypallogo {
		height: 28px;
	}

	#product {
		height: 44px;
	}

	.btn.btn-paypal {
		color: #111111;
		background-color: #FFC439;
		border-color: transparent;
		font-family: Verdana, sans-serif;
		font-weight: bold;
		font-style: italic;
		width: 120px;
		border-radius: 18px;
	}

	.btn.btn-paypal:hover {
		box-shadow: inset 0 0 100px 100px rgba(0, 0, 0, 0.05);
	}

	.btn.btn-paypal:focus {
		box-shadow: -1px -1px 18px 1px rgba(0, 0, 0, 0.25) inset;
	}

	.btn.btn-banwire {
		color: #111111;
		background-color: #e62e42;
		border-color: transparent;
		font-family: 'Montserrat', sans-serif;
		font-weight: normal;
		width: 120px;
		border-radius: 18px;
	}

	.btn.btn-banwire:hover {
		box-shadow: inset 0 0 100px 100px rgba(0, 0, 0, 0.05);
	}

	.btn.btn-banwire:focus {
		box-shadow: -1px -1px 18px 1px rgba(0, 0, 0, 0.25) inset;
	}
</style>

<body>
	<nav class = "navbar navbar-pp">
		<div class = "container">
			<a href = "https://pmz94.github.io" class = "navbar-brand">
				<img src = "https://pmz94.github.io/pagpersonal/asset/img/navbar/benny.png" alt = "Benny" title = "Volver a la pagina principal" class = "benny-logo">
			</a>
			<button class = "navbar-toggler" type = "button" data-toggle = "collapse" data-target = "#navbarNav" aria-controls = "navbarNav" aria-expanded = "false" aria-label = "Toggle navigation">
				<span class = "navbar-toggler-icon"></span>
			</button>
			<div class = "collapse navbar-collapse" id = "navbarNav">
				<ul class = "navbar-nav">
					<li class = "nav-item active">
						<img class = "nav-link paypallogo" src = "asset/img/paypal-logo.svg">
					</li>
					<li class = "nav-item">
						<img class = "nav-link paypallogo" src = "asset/img/banwire-logo.png">
					</li>
				</ul>
			</div>
		</div>
	</nav>
	<div class = "container text-center">
		<div class = "row justify-content-center">
			<div class = "col-auto">
				<div class = "UI">
					<div class = "box">
						<h2><strong>Paga algo</strong></h2>
						<hr>
						<form id = "form" action = "crearpago.php" method = "POST" autocomplete = "off">
							<!--<div class = "form-group">
								<input class = "form-control" type = "text" name = "product" placeholder = "Producto" required>
							</div>-->
							<div class = "form-group">
								<select id = "product" class = "form-control" name = "product">
									<option disabled = "disabled" selected = "selected">Servicio</option>
									<option data-price = "440">Inscripcion</option>
									<option data-price = "350">Materia</option>
									<option data-price = "440">Colegiatura</option>
									<option data-price = "350">Idioma</option>
									<option data-price = "120">Credencial</option>
									<option data-price = "200">Examen de Regularización</option>
									<option data-price = "350">Materias Sueltas</option>
									<option data-price = "270">Certificado Parcial</option>
									<option data-price = "270">Examen de Pasantía</option>
									<option data-price = "290">Duplicado de Certificado</option>
									<option data-price = "650">Cursos de Verano</option>
									<option data-price = "70">Constancias</option>
									<option data-price = "70">Kárdex</option>
									<option data-price = "60">Folletos Sueltos</option>
									<option data-price = "20">Resello de Credencial</option>
								</select>
							</div>
							<div class = "form-group">
								<input class = "form-control" type = "number" name = "price" placeholder = "Precio/Unidad" min = "1" readonly required>
							</div>
							<div class = "form-group">
								<input class = "form-control" type = "number" name = "quantity" placeholder = "Cantidad" min = "1" max = "50" required>
							</div>
							<hr>
							<h6>Total: $<span id = "total">0</span></h6>
							<div>
								<input class = "btn btn-paypal" type = "submit" value = "PayPal">
								<a id = "bw" class = "btn btn-banwire">BanWire</a>
							</div>
							<div class = "row">
								<div class = "col">
									<hr>
								</div>
								<div>o</div>
								<div class = "col">
									<hr>
								</div>
							</div>
							<div>
								<a href = "pagos.php" class = "btn btn-paypal-2">Ver movimientos</a>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>
	<script src = "https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.js"></script>
	<script src = "https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.1/js/bootstrap.js"></script>
	<script type = "text/javascript" src = "https://sw.banwire.com/checkout.js"></script>
	<script src = "asset/js/script.js"></script>
	<script type = "text/javascript">
		$(function() {
			function calcular() {
				var precio = $('#product option:selected').data('price');
				$('[name="price"]').val(precio);
				var cantidad = $('[name="quantity"]').val();
				var total = precio * cantidad;
				$('#total').text(isNaN(total) === true ? 0 : total);
			}

			$('#product').change(function() {
				calcular();
			});
			$('[name="quantity"]').keyup(function() {
				calcular();
			});

			function pagar() {
				var servicio = $('#product option:selected').text();
				var precio = $('#product option:selected').data('price');
				var cantidad = $('[name="quantity"]').val();
				var total = precio * cantidad;

				if(servicio == 'Servicio' || precio == null || cantidad == null) {
					alert('Llena los campos');
				} else {
					var SW = new BwGateway({
						sandbox: true, // Quitar o establecer a false cuando pase a produccion
						user: 'pruebasbw', // Nombre de usuario de Banwire
						title: 'El Comercio', // Titulo de la ventana
						reference: 'testref01', // Referencia
						concept: 'Pago de servicios estudiantiles', // Concepto
						currency: 'MXN', // Opcional: Moneda
						exchangeRate: '', // Opcional: Tipo de cambio definido por el comercio (En caso de seleccionar una moneda que requiera mostrar el tipo de cambio a MXN. Solo informativo). Ejemplo: 15.00
						total: total, // Total de la compra
						months: [3, 6, 9, 12], // Opcional: Meses sin intereses
						// Arreglo con los items de compra
						items: [
							{
								name: servicio,
								qty: cantidad,
								desc: 'Servicio estudiantil',
								unitPrice: precio
							}
						],
						cust: {
							fname: 'Ricardo', //Nombre del comprador
							mname: 'Gamba', //Apellido paterno del comprador
							lname: 'Lavin', //Apeliido materno del comprador
							email: 'prueba@banwire.com', //Email del comprador
							phone: '55555555', //Número telefónico del comprador
							addr: 'Direccion 440', //Dirección del comprador (calle y número)
							city: 'Mexico', //Ciudad del comprador
							state: 'DF', //Estado del comprador (2 dígitos de acuerdo al formato ISO)
							country: 'MEX', //País del comprador (3 dígitos de acuerdo al formato ISO)
							zip: '14145' //Código de postal del comprador
						},
						ship: {
							addr: 'Direccion 440', //Dirección de envío
							city: 'Mexico', //Ciudad de envío
							state: 'DF', //Estado de envío (2 dígitos de acuerdo al formato ISO)
							country: 'MEX', //País de envío (3 dígitos de acuerdo al formato ISO)
							zip: '14145' //Código de postal del envío
						},
						// Cierre automático de la ventana. Por defecto es indefinido y no cerrará la ventana. (el valor es en segundos. valor minimo requerido 60 segundos.)
						time: 900, // Ejemplo de cierre de ventana automáticamente en 15 minutos
						// Opciones de pago, por defecto es "all". Puede incluir varias opciones separadas por comas
						paymentOptions: 'all', // visa,mastercard,amex,oxxo,speifast,all
						reviewOrder: true, // Mostrar o no pagina de resumen de compra
						showShipping: false, // Mostrar o no mostrar los campos de envio
						// Solamente para pagos recurrentes o suscripciones
						// recurring: {
						//     // Cada cuanto se ejecutará el pago "month","year" o un entero representando numero de días
						//     interval: "month",
						//     // Opcional: Limitar el número de pagos (si no se pone entonces no tendrá limite)
						//     limit: 10,
						//     // Opcional: Fecha del primer cargo (en caso de no especificar se ejecutará de inmediato)
						//     start: "2014-01-01", // Formaro YYYY-MM-DD
						//     // Opcional: En caso de que los pagos subsecuentes (después del primero)
						//     // tengan un monto distinto al inicial
						//     total: "50.00"
						// },
						notifyUrl: 'https://75ac193a.ngrok.io/PayPalPrueba/recibir.php', // URL donde se van a enviar todas las notificaciones por HTTP POST de manera asoncrónica
						successPage: 'https://75ac193a.ngrok.io/PayPalPrueba', // Handler en caso de exito en el pago
						onSuccess: function(data) {
							alert('¡Gracias por tu pago!')
						},
						pendingPage: 'http://yahoo.com', // Pago pendiente OXXO
						onPending: function(data) {
							alert('El pago está pendiente por ser efectuado');
						},
						challengePage: 'http://challenge.com', // Pago challenge
						onChallenge: function(data) {
							alert('Pago enviado a validaciones de seguridad');
						},
						errorPage: 'http://facebook.com', // Handler en caso de error en el pago
						onError: function(data) {
							alert('Error en el pago');
						},
						// Cuando cierra el popup sin completar el proceso
						onCancel: function(data) {
							alert('Se cancelo el proceso, no se pudieron pagar los $' + data.total);
						}
					});

					SW.pay(); // Podemos pagar con los valores por defecto
					// O podemos modificar los valores antes de efectuar el pago
					/*SW.pay({
						total: 500,
						concept: 'Concepto nuevo'
					});
					*/
				}
			}

			$('#bw').on('click', pagar);
		});
	</script>
</body>

</html>